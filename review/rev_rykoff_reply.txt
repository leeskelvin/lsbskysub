The paper is in very good shape, and is very interesting and thorough.  Thank
you very much!  I do have some comments, of course.  Nothing major, I'm going
to go through section by section with my comments.

Abstract:

- "...undetected faint galaxies and wings of brighter objects..."  One
of the things I am very interested in, and do not know and was hoping this
paper could answer: which is more important of these two effects, the faint
galaxies or the wings of bright objects?  Or are they equally important?  Is
this something that could be addressed with the current data used in the paper?

LSK: Yes, we do touch on this in Section 6 (Conclusions), as we find that the
effect of including/excluding the faintest galaxies modifies the background
estimate by ~3.2 electrons/pixel, whilst switching from more compact sources to
more extended sources with large wings modifies the background estimate by
~0.73 electrons/pixel. This will be clarified in a re-write of the conclusions
section, and highlighted earlier in the text.

S1:

- I don't know what an "intensity moments apodization filter" is...

LSK: (one for TT to answer?)

- "Neither SExtractor nor FOCAS are user supported".  I don't know what this is
  referring to.

LSK: We're referring to the fact that these are not open source projects - in
the next sentence we write about how widely used SExtractor is in the
literature, therefore justifying its use in this study.

- Thank you for using round numbers for your reference cosmology where it is
  important.

LSK: (do we actually use cosmology in the study? I put these numbers in as
boilerplate, but in the end, I don't think we need this to be stated.)

S2.1:

- I believe these data that you're using are _coadd_ calexps, and not
  single-epoch calexps, correct?

LSK: yes, that is correct, these are deepCoadd_calexp data files. The text will
be updated to make that clear.

Throughout the paper the fact that these
analyses are run on coadds is not explicitly addressed, which makes a big
difference when using sextractor, doing units, etc.  In fact, one of my more
substantial questions involves the units employed.  The units of the DM stack
coadds are not ADU, and I'm not sure if the units quoted in the paper are
therefore correct.  When using sextractor on coadds, it can get very confused
about the discontinuous PSF.  However, I believe the actual runs are done on
simulations based on the not-great-modeled PSF, and this should be internally
consistent.

LSK: This is a good point, and thank you for raising it. Yes, as these are
coadded data, the units should not be referred to as ADUs. We will switch to the
more generic phrase 'counts' to describe the natural units found in a typical
HSC coadd image, and add a clarification sentence the first time this is
mentioned in the study to explain our language here. And yes, you are correct
in that the actual runs are done on completely simulated imaging using the PSF
we derive from our input coadded HSC data, and so should therefore be internally
consistent.

- When quoting object densities, number per arcmin^2 is the "standard" unit.

LSK: Section 2.1/Figure 1 will be updated to this, thank you.

S3.1:

- Is any star/galaxy separation done at the step when you compute number as a
  function of magnitude?  (On the data side or the sim side?)

LSK: not explicitly at this stage, however, in the next section (3.2) we use
the CLASS_STAR parameter from SExtractor to remove obvious stars for
generating our size-magnitude relation. Testing showed us that including these
objects did not significantly change our recovered log-linear best fit lines to
the number density relations, especially as we're only fitting to the range
22 < m_r < 25 mag. We wanted to leave obvious stars and shredded sources in this
figure to help justify the necessity for a simulated bright-end sample instead
of using the detected bright sources directly.

- In Figure 5, is it possible to show an overplot of one of the curves from the
  low density region on the high density region plot to see how the sides stack
  up against each other?

LSK: (this could be done, but I worry about how 'busy' the plots already are,
and I'm reluctant to make them even busier...)

S3.2:

- For the apparent bias in half light radius, is this because we have higher
  density or just deeper with better seeing?

LSK: in the paper, we speculate that it's the latter. You can see the two
stellar loci clearly sticking out at ~1 pixel and ~2 pixels (even after
removal of 'obvious' stars using the CLASS_STAR parameter), which is evidence
for this kind of bias effect.

S3.8:

- This makes sense to get the sky level and noise which we can't recover
  directly from the coadds (Unfortunately! We should fix this!).  However, the
  units are not actually "gain" because we're talking about coadds here which
  have already been transformed.  This is somewhat of an "equivalent gain", but
  the units quoted here aren't correct.

LSK: thank you, this is a great point. We will modify the language used here and
elsewhere to be 'equivalent gain' instead.

Figure 9:

- The caption says "the impact of source density (contrasting the top row with
  the bottom)", but the top/bottom is all/bright not anything to do with source
  density.

LSK: Apologies, this is something that we should explain better in the earlier
sections of the text. We have two source density types in our simulated imaging.
The first type of simulated images contain every source alluded to in Figure 5,
i.e., everything from m_r ~15 mag down to m_r = 30 mag. This we refer to here as
'all simulated sources'. Our second set of simulated images contain only a
subset of the simulated sources in 'all', namely, only those simulated sources
that would typically be detected by SExtractor. This excludes most of the faint
end sources, and leaves you with only the 'bright' end simulated data. As a
consequence, we refer to this simulated subset as 'bright sources only'. If you
have any suggestions as to how we might improve our naming conventions here,
we'll be happy to update our nomenclature.

S4.2:

- "...bright sources are the primary culprits...".  Is this demonstrated here,
  or just asserted?

LSK: this is demonstrated later in the text, but yes, you are correct that it's
too early to assert this here. We'll update this sentence to read:
"Firstly, if extended sources do act to negatively impact sky estimation
routines, then it's the brightest of these sources that will have the largest
per-object impact overall, with their broad wings overlapping a relatively
larger number of secondary objects."

- As mentioned above, fitting coadd psfs with psfex and sextractor is a world
  of hurt (technical term), but as a reference psf to use for sims should
  probably be fine.

LSK: I think the PSF we've derived looks to be fairly robust (cf. Figure 4),
however, I agree that using it in construction of our simulated images should be
okay here regardless.

S5:

- Units are not actually e-/pixel.

LSK: (counts are converted to e- using equivalent gain, but Eli is correct that
equivalent gain is not the same as gain, and so cannot be used to convert to
electrons directly. I'm not sure that 'equivalent electrons' exist! We might be
safer switching to magnitudes here, where a conversion is known and well
understood).

- "Simulated datasets with faint EBL sources excluded always outperform...";
  "mischaracterization of such sources is the single largest contributor".  So
  is this in conflict to the "bright sources are the primary culprits" line
  from S4.2?

LSK: Yes, it was, thank you. We meant to imply that bright sources are the
single largest contributor to sky mis-estimation on a per-object basis, but,
taken together, the mass of ~500000 faint missing EBL sources are the largest
overall contributor to sky mis-estimation. The "bright sources" text already
mentioned above has already been modified to reflect this subtlety, and we'll
re-write the text here to clarify this also.

- "Sky misestimation produced by a default sextractor run was reduced by 8sigma
  in the case of a random galaxy distribution".  I'm not sure what this
  sentence means or the 8sigma is referring to.

LSK: (TT, I think this is text you added?)

- "background map level of deltaf = 0.91 +/- 0.81".  Is this significant?

LSK: (This is just above 1-sigma as shown, so not our most significant result.
Nevertheless, we need to re-address this once we've standardised our units.)

- "Global mean offsets do not tell the whole story...": Just to confirm, is the
  background brightness of the sims 0 flux?  I don't believe this is explicitly
  stated.

LSK: In Section 3.10 we write "These simulated images are background subtracted
(i.e., Poisson noise oscillates about a level of zero counts)...". We also show
an example GalSim input file which explicitly states that the input sky_level
value is 0. If it helps however, we could remind the reader of this elsewhere in
the text?

And this implies that the sky is always overestimated, and never
underestimated?

LSK: For these 'a-type' simulated images (i.e., images containing simulated
sources all the way down to m_r=30 mag) then yes, the sky level is always
over-estimated. For the 'b-type' simulated images (i.e., with EBL excluded), the
recovered sky level was indeed found to oscillate around zero counts. However,
it was impossible to plot these b-type simulated images in Figure 17, as our
z-axis color map is in magnitudes.

Also, what is the variance of the background for each mode
of operation?  If the background is truly flat and 0, the variance in the
recovered background is equally important to the mean, I believe.  I think
more about the background variance comparison of the different runs would be
interesting.

LSK: (not quite sure how to answer this one?)

- "Default GNUAstro operational modes...".  This worries me that it's removing
  noise and not actually getting to where we need it to be finding the
  _background_.

Yes, as shown in Figure 15 for example, GNUastro can tend to bring in a lot of
noise and merge it into a large, bright object. This is a weakness of GNUAstro,
and not present in SExtractor outputs. You can see the negative impact of this
for GNUAstro outputs in Figure 20, whereby GNUAstro actually over-estimates
the flux in exponential-type sources by ~10%!

 S6:

 - The conclusion section is a bit wordy.  This either needs to be distilled
   down, or the section renamed and Conclusions rewritten with a distillation.

LSK: Thank you for this feedback. We will significantly re-write the
conclusions section to simplify and focus on our primary conclusions.
